---
serviceAccount:
  name: argocd-image-updater

authScripts:
  enabled: true
  scripts:
    auth.sh: |
      #!/bin/sh
      # Get the token and split it into username and password
      AUTH=$(aws ecr --region ap-south-1 get-authorization-token --output text --query 'authorizationData[].authorizationToken' | base64 -d)
      # Print in the required format
      echo "${AUTH}" | awk '{split($0,a,":"); print "AWS:"a[2]}'

config:
  registries:
  - name: ECR
    api_url: https://api.ecr.ap-south-1.amazonaws.com
    prefix: 264278751395.dkr.ecr.ap-south-1.amazonaws.com
    ping: yes
    insecure: no
    credentials: ext:/scripts/auth.sh
    credsexpire: 10h